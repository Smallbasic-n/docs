---
title: システム要求
weight: 1
---

K3s は非常に軽量ですが、以下に概説するようにいくつかの最小要件があります。

K3s をコンテナーで実行するように構成するか、ネイティブの Linux サービスとして実行するように構成するかに関係なく、K3s を実行する各ノードは次の最小要件を満たす必要があります。 これらの要件は、K3s とそのパッケージ コンポーネントのベースラインであり、ワークロード自体によって消費されるリソースは含まれません。

## 前提条件

2 つのノードが同じホスト名を持つことはできません。

複数のノードが同じホスト名を持つ場合、またはホスト名が自動プロビジョニング システムによって再利用される可能性がある場合は、`--with-node-id` オプションを使用して各ノードにランダムなサフィックスを追加するか、一意の名前を考案して渡します クラスターに追加する各ノードの「--node-name」または「$K3S_NODE_NAME」。
## オペレーティングシステム

K3s は、最新の Linux システムのほとんどで動作することが期待されています。

一部の OS には特定の要件があります。

- **(Red Hat/CentOS) Enterprise Linux** を使用している場合は、[これらの手順](../advanced/advanced.md#red-hat-enterprise-linux--centos) に従って追加のセットアップを行います。
- **Raspberry Pi OS** を使用している場合は、[これらの手順](../advanced/advanced.md#raspberry-pi) に従ってレガシー iptables に切り替えます。

Rancher が管理する K3s クラスターでテストされた OS の詳細については、[Rancher のサポートおよびメンテナンス条件](https://rancher.com/support-maintenance-terms/) を参照してください。

## ハードウェア

ハードウェア要件は、展開のサイズに基づいて調整されます。 ここでは、最低限の推奨事項について概説します。

* RAM: 512MB 以上 (1GB 以上を推奨)
* CPU: 最小1コア
[K3s Resource Profiling](../reference/resource-profiling.md) は、K3s エージェント、ワークロードを持つ K3s サーバー、および 1 つのエージェントを持つ K3s サーバーの最小リソース要件を決定するためのテストの結果をキャプチャします。 また、K3s サーバーとエージェントの使用率に最も大きな影響を与えるもの、およびエージェントとワークロードからの干渉からクラスター データストアを保護する方法についての分析も含まれています。

#### ディスク

K3s のパフォーマンスは、データベースのパフォーマンスに依存します。 最適な速度を確保するために、可能な場合は SSD を使用することをお勧めします。 ディスクのパフォーマンスは、SD カードまたは eMMC を使用する ARM デバイスによって異なります。

## ネットワーキング

K3s サーバーには、すべてのノードからアクセスできるポート 6443 が必要です。

ノードは、Flannel VXLAN が使用されている場合は UDP ポート 8472 を介して、または Flannel Wireguard バックエンドが使用されている場合は UDP ポート 51820 および 51821 (IPv6 を使用している場合) を介して他のノードに到達できる必要があります。 ノードは他のポートをリッスンしてはなりません。 K3s はリバース トンネリングを使用して、ノードがサーバーへのアウトバウンド接続を確立し、すべての kubelet トラフィックがそのトンネルを通過するようにします。 ただし、Flannel を使用せず、独自のカスタム CNI を提供する場合、Flannel に必要なポートは K3s には必要ありません。

メトリクス サーバーを使用する場合は、すべてのノードがポート 10250 で相互にアクセスできる必要があります。

組み込みの etcd を使用して高可用性を実現することを計画している場合、サーバー ノードはポート 2379 および 2380 で相互にアクセスできる必要があります。

> **重要:** ノードの VXLAN ポートは、誰でもアクセスできるようにクラスター ネットワークを開くため、外部に公開しないでください。 ポート 8472 へのアクセスを無効にするファイアウォール/セキュリティ グループの背後でノードを実行します。
> **警告:** Flannel は [Bridge CNI プラグイン](https://www.cni.dev/plugins/current/main/bridge/) に依存して、トラフィックを切り替える L2 ネットワークを作成します。 NET_RAW 機能を備えた不正ポッドは、その L2 ネットワークを悪用して、[ARP スプーフィング](https://static.sched.com/hosted_files/kccncna19/72/ARP%20DNS%20spoof.pdf) などの攻撃を仕掛けることができます。 したがって、[kubernetes ドキュメント](https://kubernetes.io/docs/concepts/security/pod-security-standards/) に記載されているように、信頼できないポッドで NET_RAW を無効にする制限付きプロファイルを設定してください。
<figcaption>K3s サーバー ノードのインバウンド ルール</figcaption>

| | プロトコル | ポート | ソース | 目的地 | 説明
|---------|-----------|-----------|-------------| ------------
| | TCP | TCP | 2379-2380 | サーバー | サーバー | etcd が組み込まれた HA にのみ必要
| | TCP | TCP | 6443 | エージェント | サーバー | K3s スーパーバイザーと Kubernetes API サーバー
| | UDP | 8472 | すべてのノード | すべてのノード | Flannel VXLAN にのみ必要
| | TCP | TCP | 10250 | すべてのノード | すべてのノード | Kubelet メトリクス
| | UDP | 51820 | すべてのノード | すべてのノード | IPv4 を使用する Flannel Wireguard にのみ必要
| | UDP | 51821 | すべてのノード | すべてのノード | IPv6 を使用する Flannel Wireguard にのみ必要

通常、すべてのアウトバウンド トラフィックが許可されます。

## 大規模クラスター

ハードウェア要件は、K3s クラスターのサイズに基づいています。 本番および大規模なクラスターの場合は、外部データベースを使用した高可用性セットアップを使用することをお勧めします。 本番環境の外部データベースには、次のオプションが推奨されます。

-MySQL
- PostgreSQL
- etcd
### CPU とメモリ

高可用性 K3s サーバーのノードの CPU とメモリの最小要件は次のとおりです。

| | 展開サイズ | ノード | ノード VCPU | ラム |
|:------:|:--------:|:-----:|:-----:|
| | 小さい | 最大 10 | 2 | 4GB |
| | ミディアム | ミディアム | 最大 100 | 4 | 8GB |
| | 大 | 最大 250 | 8 | 16GB |
| | 特大 | 最大 500 | 16 | 32GB |
| | XX-ラージ | 500+ | 32 | 64GB |

### ディスク

クラスターのパフォーマンスは、データベースのパフォーマンスに依存します。 最適な速度を確保するために、常に SSD ディスクを使用して K3s クラスターをバックアップすることをお勧めします。 クラウド プロバイダーでは、最大 IOPS を可能にする最小サイズも使用する必要があります。

### ネットワーキング

ポッドの IP が不足しないように、クラスター CIDR のサブネット サイズを大きくすることを検討する必要があります。 これを行うには、起動時に「--cluster-cidr」オプションを K3s サーバーに渡します。

### データベース

K3s は、MySQL、PostgreSQL、MariaDB、etcd などのさまざまなデータベースをサポートしています。以下は、大規模なクラスターを実行するために必要なデータベース リソースのサイジング ガイドです。

|  展開サイズ | ノード | ノード VCPU | ラム |
|:-----:|:--------:|:-----:|:-----:|
|  小さい | 最大 10 | 1 | 2GB |
|  ミディアム | ミディアム | 最大 100 | 2 | 8GB |
|  大 | 最大 250 | 4 | 16GB |
|  特大 | 最大 500 | 8 | 32GB |
|  XX-ラージ | 500+ | 16 | 64GB |